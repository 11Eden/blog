# JavaScript事件循环(Event Loop)机制

## 单线程

## JavaScript 是单线程单并发语言

1. 什么是单线程

    主程序只有一个线程，即同一时间片断内其只能执行单个任务。

2. 为什么选择单线程？

    JavaScript的主要用途是与用户互动，以及操作DOM。这决定了它只能是单线程，否则会带来很复杂的同步问题。

3. 单线程意味着什么？

    单线程就意味着，所有任务都需要排队，前一个任务结束，才会执行后一个任务。如果前一个任务耗时很长，后一个任务就需要一直等着。这就会导致`IO操作（耗时但cpu闲置）`时造成性能浪费的问题。

4. 如何解决单线程带来的性能问题？

    答案是**异步**！主线程完全可以不管IO操作，暂时挂起处于等待中的任务，先运行排在后面的任务。等到IO操作返回了结果，再回过头，把挂起的任务继续执行下去。于是，所有任务可以分成两种，一种是同步任务（synchronous），另一种是异步任务（asynchronous）

JavaScript 内存分配

1. 调用栈（Call Stack）：用于主线程任务的执行
2. 堆（Heap）： 用于存放非结构化数据，譬如程序分配的变量与对象
3. 任务队列（Queue）： 用于存放异步任务与定时任务。

## 事件循环（Event Loop）

为什么叫事件循环？是因为它是一个循环：

+ 所有同步任务都在主线程上执行，形成一个执行栈（execution context stack）。
+ 主线程之外，还存在一个"任务队列"（task queue）。只要异步任务有了运行结果，就在"任务队列"之中放置一个事件。
+ 一旦"执行栈"中的所有同步任务执行完毕，系统就会读取"任务队列"，看看里面有哪些事件。那些对应的异步任务，于是结束等待状态，进入执行栈，开始执行。
+ 主线程不断循环执行上面的第三步。

![](data:image/png;base64,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)

这就需要主线程拥有一个函数调用栈以及一个任务队列


根据事件循环（Event Loop）机制来从任务队列中提取出待执行的回调并执行

在主线程中，根据任务队列依次执行任务，
在当前任务中，根据函数函数调用栈，依次执行代码


主线程会依次执行代码，当遇到函数时，会先将函数入栈，函数运行完毕后再将该函数出栈，直到所有代码执行完毕。当函数调用栈为空时，运行时即会根据事件循环（Event Loop）机制来从任务队列中提取出待执行的回调并执行，执行的过程同样会进行函数帧的入栈出栈操作。


回调的事件会将其相关的任务压入到任务队列中



+ 浏览器内核会在其它线程中执行异步操作，当操作完成后，将操作结果以及事先定义的回调函数放入 JavaScript 主线程的任务队列中。
+ JavaScript 主线程会在执行栈清空后，读取任务队列，读取到任务队列中的函数后，将该函数入栈，一直运行直到执行栈清空，再次去读取任务队列，不断循环。
+ 当主线程阻塞时，任务队列仍然是能够被推入任务的。这也就是为什么当页面的 JavaScript 进程阻塞时，我们触发的点击等事件，会在进程恢复后依次执行。

JavaScript 的主线程在遇到异步调用时，这些异步调用会立刻返回某个值，从而让主线程不会在此处阻塞。而真正的异步操作会由浏览器执行，主线程则会在清空当前调用栈后，按照先入先出的顺序读取任务队列里面的任务。

JavaScript 内存模型：




## 任务

1. MacroTask，即Task
    setTimeout, setInterval, setImmediate, requestAnimationFrame, I/O, UI rendering 

2. MicroTask，即Job
     process.nextTick, Promise, Object.observe, MutationObserver 

规则：
> 一个事件循环(Event Loop)会有一个或多个 MacroTask Queue，而仅有一个 MicroTask Queue。每个 MacroTask Queue 都保证自己按照回调入队的顺序依次执行，所以浏览器可以从内部到JS/DOM，保证动作按序发生。当前任务中所生成的 MicroTask ，都会添加到 MicroTask Queue， 并在当前任务执行完毕后，立即执行，在 MacroTask 或者 MicroTask 中产生的 MicroTask 同样会被压入到 MicroTask 队列中并执行。

```js

function ELoop() {
    // 当前任务
    let p = new Promise((resolve, reject)=>{
        console.log("current Task")
        resolve();
    });
    let nextP; 

    setTimeout(()=>{
        console.log("MacroTask_1");
        nextP.then(()=>{
            // 第一次执行时，这段代码并没有执行到。
            console.log("MicroTask_promise_1"); //第一个MicroTask
        })
        console.log("MacroTask_1 end")
    }, 0) // 第一个 MacroTask

    setTimeout(()=>{
        console.log("MacroTask_2");
        console.log("MacroTask_2 end")
    }, 0)// 第二个MacroTask

    nextP = p.then(()=>{
        console.log("MicroTask_promise_2"); //第一个MicroTask
        console.log(1)
    }).then(()=>{
        console.log("MicroTask_promise_3"); // 第二个MicroTask
        console.log(1)
    })

    console.log("current Task end")
}

ELoop();

/**输出结果：
current Task
MicroTask_promise_2
MicroTask_promise_3
MacroTask_1
MicroTask_promise_1
MacroTask_2
**/
```


异步操作：

+ DOM

+ 网络

+ 定时器


## 为什么要异步
单线程，
IO操作慢，但cpu空闲

## Event Loop
主线程从"任务队列"中读取事件，这个过程是循环不断的，
所以整个的这种运行机制又称为Event Loop（事件循环）。